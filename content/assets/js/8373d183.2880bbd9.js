"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[4875],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,f=p["".concat(l,".").concat(m)]||p[m]||d[m]||i;return n?a.createElement(f,o(o({ref:t},u),{},{components:n})):a.createElement(f,o({ref:t},u))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},70502:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(87462),r=(n(67294),n(3905));const i={id:"txn-advanced-features",title:"Advanced features",sidebar_label:"Advanced features",description:"Get a comprehensive understanding of advanced features of transactions in Pulsar."},o=void 0,s={unversionedId:"txn-advanced-features",id:"txn-advanced-features",title:"Advanced features",description:"Get a comprehensive understanding of advanced features of transactions in Pulsar.",source:"@site/docs/txn-advanced-features.md",sourceDirName:".",slug:"/txn-advanced-features",permalink:"/docs/next/txn-advanced-features",draft:!1,editUrl:"https://github.com/apache/pulsar-site/edit/main/docs/txn-advanced-features.md",tags:[],version:"current",frontMatter:{id:"txn-advanced-features",title:"Advanced features",sidebar_label:"Advanced features",description:"Get a comprehensive understanding of advanced features of transactions in Pulsar."},sidebar:"docsSidebar",previous:{title:"Get started",permalink:"/docs/next/txn-use"},next:{title:"Monitoring",permalink:"/docs/next/txn-monitor"}},l={},c=[{value:"Ack batch messages",id:"ack-batch-messages",level:2},{value:"Enable authentication",id:"enable-authentication",level:2},{value:"Select transaction isolation level",id:"select-transaction-isolation-level",level:2},{value:"Guarantee exactly-once semantics",id:"guarantee-exactly-once-semantics",level:2},{value:"Related topics",id:"related-topics",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"You can use the following advanced features with transactions in Pulsar."),(0,r.kt)("h2",{id:"ack-batch-messages"},"Ack batch messages"),(0,r.kt)("p",null,"If you want to acknowledge batch messages with transactions, set ",(0,r.kt)("inlineCode",{parentName:"p"},"acknowledgmentAtBatchIndexLevelEnabled")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/pulsar/blob/master/conf/broker.conf"},(0,r.kt)("inlineCode",{parentName:"a"},"broker.conf"))," or ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/pulsar/blob/master/conf/standalone.conf"},(0,r.kt)("inlineCode",{parentName:"a"},"standalone.conf"))," file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf"},"acknowledgmentAtBatchIndexLevelEnabled=true\n")),(0,r.kt)("p",null,"This example enables batch messages ack in transactions in the consumer builder."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'Consumer<byte[]> consumer = pulsarClient\n    .newConsumer()\n    .topic(transferTopic)\n    .subscriptionName("transaction-sub")\n    .subscriptionInitialPosition(SubscriptionInitialPosition.Earliest)\n    .subscriptionType(SubscriptionType.Shared)\n    .enableBatchIndexAcknowledgment(true) // enable batch index acknowledgment\n    .subscribe();\n')),(0,r.kt)("h2",{id:"enable-authentication"},"Enable authentication"),(0,r.kt)("p",null,"If you want to enable authentication with transactions, follow the steps below."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"/docs/next/admin-api-topics#grant-permission"},'Grant "consume" permission')," to the ",(0,r.kt)("inlineCode",{parentName:"p"},"persistent://pulsar/system/transaction_coordinator_assign")," topic.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"security-overview/#authentication"},"Configure authentication")," in a Pulsar client."))),(0,r.kt)("h2",{id:"select-transaction-isolation-level"},"Select transaction isolation level"),(0,r.kt)("p",null,"To enhance the flexibility of Pulsar transactions, they support two distinct isolation levels:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"READ_COMMITTED"),"(default): The consumer can only consume all transactional messages that have been committed."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"READ_UNCOMMITTED"),": The consumer can consume all messages, even transactional messages that have been aborted.")),(0,r.kt)("p",null,"For different scenarios, they use different subscriptions and choose different isolation levels. One scenario might require transactions, while another might not. In general, not all subscriptions of the same topic require transaction guarantees. Some want low latency without the exact-once semantic guarantee (like a real-time monitoring system), and some must require the exactly-once guarantee (e.g., business processing systems).\nUsers can freely choose different isolation levels according to different scenarios."),(0,r.kt)("p",null,"Note that this is a subscription-level configuration, and all consumers under the same subscription must be configured with the same isolation level."),(0,r.kt)("p",null,"In this example, the consumer builder uses the ",(0,r.kt)("inlineCode",{parentName:"p"},"READ_UNCOMMITTED")," isolation level."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'Consumer<String> consumer = client\n  .newConsumer(Schema.STRING)\n  .topic("persistent://my-tenant/my-namespace/my-topic")\n  .subscriptionName("my-subscription")\n  .subscriptionType(SubscriptionType.Shared)\n  .subscriptionIsolationLevel(SubscriptionIsolationLevel.READ_UNCOMMITTED) // Adding the isolation level configuration\n  .subscribe();\n')),(0,r.kt)("h2",{id:"guarantee-exactly-once-semantics"},"Guarantee exactly-once semantics"),(0,r.kt)("p",null,"If you want to guarantee exactly-once semantics with transactions, you can ",(0,r.kt)("a",{parentName:"p",href:"/docs/next/cookbooks-deduplication#enable-message-deduplication-at-namespace-or-topic-level"},"enable message deduplication at the broker, namespace, or topic level"),"."),(0,r.kt)("h2",{id:"related-topics"},"Related topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To get up quickly, see ",(0,r.kt)("a",{parentName:"li",href:"/docs/next/txn-use"},"Pulsar transactions - Get started"),".")))}d.isMDXComponent=!0}}]);