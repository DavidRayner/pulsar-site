<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Apache Pulsar 2.6.2 | Apache Pulsar</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pulsar.apache.org/img/pulsar-social-media-card.png"><meta data-rh="true" name="twitter:image" content="https://pulsar.apache.org/img/pulsar-social-media-card.png"><meta data-rh="true" property="og:url" content="https://pulsar.apache.org/blog/2020/11/09/Apache-Pulsar-2-6-2/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Apache Pulsar 2.6.2 | Apache Pulsar"><meta data-rh="true" name="description" content="We are excited to see that the Apache Pulsar community has successfully released the 2.6.2 version after a lot of hard work. It is a great milestone for this fast-growing project and the Pulsar community. 2.6.2 is the result of a big effort from the community, with over 154 commits and a long list of improvements and bug fixes."><meta data-rh="true" property="og:description" content="We are excited to see that the Apache Pulsar community has successfully released the 2.6.2 version after a lot of hard work. It is a great milestone for this fast-growing project and the Pulsar community. 2.6.2 is the result of a big effort from the community, with over 154 commits and a long list of improvements and bug fixes."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-11-09T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://twitter.com/wolf4j1"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pulsar.apache.org/blog/2020/11/09/Apache-Pulsar-2-6-2/"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/blog/2020/11/09/Apache-Pulsar-2-6-2/" hreflang="en"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/blog/2020/11/09/Apache-Pulsar-2-6-2/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://WK2YL0SALL-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Apache Pulsar" href="/opensearch.xml">




<link rel="stylesheet" href="/css/katex-0.13.24.min.css" media="print" onload="this.media=&#39;all&#39;">
<script src="/js/sine-waves.min.js" async></script>
<script src="/js/matomo-agent.js"></script><link rel="stylesheet" href="/assets/css/styles.96a66374.css">
<link rel="preload" href="/assets/js/runtime~main.e61b3335.js" as="script">
<link rel="preload" href="/assets/js/main.47f55566.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-black.svg" alt="Apache Pulsar logo" class="themedImage_ToTc themedImage--light_HNdA" height="25" width="127"><img src="/img/logo-black.svg" alt="Apache Pulsar logo" class="themedImage_ToTc themedImage--dark_i4oU" height="25" width="127"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Get Started</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/3.2.x/concepts-overview/">Concepts</a></li><li><a class="dropdown__link" href="/docs/3.2.x/">Quickstart</a></li><li><a class="dropdown__link" href="/ecosystem/">Ecosystem</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/3.2.x/">Docs</a><a class="navbar__item navbar__link" href="/contribute/">Contribute</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link community-dropdown">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link scroll-link scroll-welcome" id="scroll-welcome" href="/community/">Welcome</a></li><li><a class="dropdown__link scroll-link scroll-discussions" id="scroll-discussions" href="/community/#section-discussions">Discussions</a></li><li><a class="dropdown__link scroll-link" id="scroll-governance" href="/community/#section-governance">Governance</a></li><li><a class="dropdown__link scroll-link" id="scroll-community" href="/community/#section-community">Meet the Community</a></li><li><a class="dropdown__link scroll-link" id="scroll-contribute" href="/community/#section-contribute">Contribute</a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Wiki</a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link">Issue Tracking</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/blog/">Blog</a></li><li><a class="dropdown__link" href="/books/">Books</a></li><li><a class="dropdown__link" href="/case-studies/">Case Studies</a></li><li><a class="dropdown__link" href="/resources/">Resources</a></li><li><a class="dropdown__link" href="/events/">Events</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar_download_button" href="/download/">Download</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/02/12/announcing-apache-pulsar-3-2/">What&#x27;s New in Apache Pulsar 3.2.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/01/12/pulsar-2023-year-in-review/">Apache Pulsar 2023 Year in Review</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/10/10/announcing-apache-pulsar-3-1/">What&#x27;s New in Apache Pulsar 3.1.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/08/28/pulsar-sessions-in-communityovercode-aisa-2023/">Recap: Apache Pulsar Sessions in CommunityOverCode Asia 2023</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/06/28/pulsar-summit-north-america-2023-cfp/">Pulsar Summit North America 2023: CFP Is Open Now!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/05/02/announcing-apache-pulsar-3-0/">Announcing Apache Pulsar 3.0: The First Long-Term Support Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/04/19/Apache-Pulsar-2-10-4/">Whatâ€™s New in Apache Pulsar 2.10.4</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/04/11/pulsar-summit-europe-2023-schedule-announced/">Speakers and Agenda Announced for Pulsar Virtual Summit Europe 2023!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/02/03/apache-pulsar-hits-its-600th-contributor/">Apache Pulsar Hits Its 600th Contributor</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/02/02/pulsar-virtual-summit-europe-2023-cfp/">Pulsar Virtual Summit Europe 2023: CFP Is Now Open!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/20/Apache-Pulsar-2-11-0/">Whatâ€™s New in Apache Pulsar 2.11</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/10/pulsar-2022-year-in-review/">Apache Pulsar 2022 Year in Review</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023/01/09/Apache-Pulsar-2-10-3/">Whatâ€™s New in Apache Pulsar 2.10.3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/12/01/pulsar-summit-asia-2022-recap/">Pulsar Summit Asia 2022 Recap</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/11/04/pulsar-summit-asia-2022-schedule-announced/">Announcing Conference Schedule for Pulsar Summit Asia 2022</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/09/09/Apache-Pulsar-2-7-5/">Whatâ€™s New in Apache Pulsar 2.7.5</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/08/22/pulsar-summit-asia-2022-cfp/">Pulsar Summit Asia 2022: CFP Is Open Now!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/07/27/Apache-Pulsar-2-9-3/">Whatâ€™s New in Apache Pulsar 2.9.3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/07/26/pulsar-sessions-in-apachecon-aisa-2022/">Apache Pulsar Sessions in ApacheCon Asia 2022: Join Us Now and Check the Schedule</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/07/15/pulsar-summit-san-francisco/">Speakers and Sponsorship Prospectus Announced for Pulsar Summit San Francisco 2022</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/07/12/Apache-Pulsar-2-10-1/">Whatâ€™s New in Apache Pulsar 2.10.1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/05/11/Apache-Pulsar-2-10-0/">Whatâ€™s New in Apache Pulsar 2.10</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/05/11/apache-pulsar-community-welcomes-500th-contributor/">The Apache Pulsar Community Welcomes 500th Contributor!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/04/08/Apache-Pulsar-2-9-2/">Whatâ€™s New in Apache Pulsar 2.9.2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/12/14/Apache-Pulsar-2-7-4/">Whatâ€™s New in Apache Pulsar 2.7.4</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/12/11/Log4j-CVE/">Log4j2 Zero Day vulnerability (CVE-2021-44228)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/09/23/Apache-Pulsar-2-8-1/">Apache Pulsar 2.8.1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/08/18/asia-cfp/">Announcing Pulsar Summit Asia 2021: CFP Is Open!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/08/11/Apache-Pulsar-2-7-3/">Apache Pulsar 2.7.3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/06/12/Apache-Pulsar-2-8-0/">Apache Pulsar 2.8.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/05/13/Apache-Pulsar-2-7-2/">Apache Pulsar 2.7.2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/12/24/Apache-Pulsar-2-7-0/">Apache Pulsar 2.7.0</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2020/11/09/Apache-Pulsar-2-6-2/">Apache Pulsar 2.6.2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/11/04/pulsar-summit-asia-schedule/">Pulsar Summit Asia 2020 Schedule is Now Online</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/09/01/pulsar-summit-asia-2020-cfp/">Pulsar Summit Asia 2020 CFP is now open</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/08/24/Pulsar-300-contributors/">Apache Pulsar Celebrates 300 Contributors</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/08/21/Apache-Pulsar-2-6-1/">Apache Pulsar 2.6.1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/06/18/Apache-Pulsar-2-6-0/">Apache Pulsar 2.6.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/05/19/Apache-Pulsar-2-5-2/">Apache Pulsar 2.5.2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/04/23/Apache-Pulsar-2-5-1/">Apache Pulsar 2.5.1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2020/03/17/announcing-the-apache-pulsar-2020-user-survey-report/">Announcing: The Apache Pulsar 2020 User Survey Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/12/20/pulsar-milestone-200-contributors/">Pulsar milestone celebrationâ€”200 contributors!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/12/18/Pulsar-summit-cfp/">Pulsar Summit San Francisco 2020 CFP is now open</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/12/04/Apache-Pulsar-2-4-2/">Apache Pulsar 2.4.2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/07/05/Apache-Pulsar-2-4-0/">Apache Pulsar 2.4.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/02/20/Apache-Pulsar-2-3-0/">Apache Pulsar 2.3.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2018/08/06/Apache-Pulsar-2-1-0/">Apache Pulsar 2.1.0-incubating</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Apache Pulsar 2.6.2</h1><div class="container_mt6G margin-vert--md"><time datetime="2020-11-09T00:00:00.000Z" itemprop="datePublished">November 9, 2020</time> Â· <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/wolf4j1" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Xiaolong Ran</span></a></div></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>We are excited to see that the Apache Pulsar community has successfully released the 2.6.2 version after a lot of hard work. It is a great milestone for this fast-growing project and the Pulsar community. 2.6.2 is the result of a big effort from the community, with over 154 commits and a long list of improvements and bug fixes.</p><p>Here are some highlights and major features added in Pulsar 2.6.2.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="broker">Broker<a href="#broker" class="hash-link" aria-label="Direct link to Broker" title="Direct link to Broker">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="catch-throwable-when-starting-pulsar">Catch <code>throwable</code> when starting Pulsar<a href="#catch-throwable-when-starting-pulsar" class="hash-link" aria-label="Direct link to catch-throwable-when-starting-pulsar" title="Direct link to catch-throwable-when-starting-pulsar">â€‹</a></h3><p>Before 2.6.2, Pulsar catched exceptions only when <code>BrokerStarter.start()</code> failed. Some errors such as <code>NoSuchMethodError</code> or <code>NoClassDefFoundError</code> could not be caught, and Pulsar was in abnormal status yet no error log was found in the log file.</p><p>In 2.6.2, we modify exceptions to use <code>throwable</code> to avoid this issue.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7221" target="_blank" rel="noopener noreferrer">PR-7221</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="handle-subscriptionbusyexception-in-resetcursor-api">Handle SubscriptionBusyException in resetCursor API<a href="#handle-subscriptionbusyexception-in-resetcursor-api" class="hash-link" aria-label="Direct link to Handle SubscriptionBusyException in resetCursor API" title="Direct link to Handle SubscriptionBusyException in resetCursor API">â€‹</a></h3><p>In <code>PersistentSubscription.resetCursor</code> method, <code>SubscriptionFencedException</code> is thrown in several places, but it is not handled in <code>PersistentTopicBase</code>, so error messages are not clear.</p><p>In 2.6.2, we export <code>SubscriptionBusyException</code> in <code>PersistentTopicBase</code> for <code>resetCursor</code>, so error messages in the REST API are clear. </p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7335" target="_blank" rel="noopener noreferrer">PR-7335</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-jersey-to-231">Update Jersey to 2.31<a href="#update-jersey-to-231" class="hash-link" aria-label="Direct link to Update Jersey to 2.31" title="Direct link to Update Jersey to 2.31">â€‹</a></h3><p>Before 2.6.1, Pulsar used the Jersey 2.27, which has security concerns. In Pulsar 2.6.2, we update the Jersey version to the latest stable version(2.31) to enhance security.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7515" target="_blank" rel="noopener noreferrer">PR-7515</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stop-to-dispatch-when-consumers-using-the-key_shared-subscription-stuck">Stop to dispatch when consumers using the Key_Shared subscription stuck<a href="#stop-to-dispatch-when-consumers-using-the-key_shared-subscription-stuck" class="hash-link" aria-label="Direct link to Stop to dispatch when consumers using the Key_Shared subscription stuck" title="Direct link to Stop to dispatch when consumers using the Key_Shared subscription stuck">â€‹</a></h3><p>Consumers using the <code>Key_Shared</code> subscription would encounter disorder messages occasionally. The following are steps to reproduce the situation:</p><ol><li>Connect Consumer1 to Key_Shared subscription <code>sub</code> and stop to receive</li></ol><ul><li>receiverQueueSize: 500</li></ul><ol start="2"><li>Connect Producer and publish 500 messages with key <code>(i % 10)</code></li><li>Connect Consumer2 to same subscription and start to receive</li></ol><ul><li>receiverQueueSize: 1</li><li>since <a href="https://github.com/apache/pulsar/pull/7106" target="_blank" rel="noopener noreferrer">https://github.com/apache/pulsar/pull/7106</a>, Consumer2 can&#x27;t receive (expected)</li></ul><ol start="4"><li>Producer publish more 500 messages with same key generation algorithm</li><li>After that, Consumer1 start to receive</li><li>Check Consumer2 message ordering</li></ol><ul><li>sometimes message ordering was broken in same key</li></ul><p>In 2.6.2, when consumers use the Key_Shared subscription, Pulsar stops dispatching messages to consumers that are stuck on delivery to guarantee message order. </p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7553" target="_blank" rel="noopener noreferrer">PR-7553</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reestablish-namespace-bundle-ownership-from-false-negative-releasing-and-false-positive-acquiring">Reestablish namespace bundle ownership from false negative releasing and false positive acquiring<a href="#reestablish-namespace-bundle-ownership-from-false-negative-releasing-and-false-positive-acquiring" class="hash-link" aria-label="Direct link to Reestablish namespace bundle ownership from false negative releasing and false positive acquiring" title="Direct link to Reestablish namespace bundle ownership from false negative releasing and false positive acquiring">â€‹</a></h3><p>In acquiring/releasing namespace bundle ownership, ZooKeeper might be disconnected before or after these operations are persisted in the ZooKeeper cluster. It leads to inconsistency between the local ownership cache and ZooKeeper cluster.</p><p>In 2.6.2, we fix the issue with the following:</p><ul><li>In ownership releasing, do not retain ownership in failure.</li><li>In ownership checking, querying and acquiring, reestablish the lost ownership in false negative releasing and false positive acquiring.</li></ul><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7773" target="_blank" rel="noopener noreferrer">PR-7773</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enable-users-to-configure-the-executor-pool-size">Enable users to configure the executor pool size<a href="#enable-users-to-configure-the-executor-pool-size" class="hash-link" aria-label="Direct link to Enable users to configure the executor pool size" title="Direct link to Enable users to configure the executor pool size">â€‹</a></h3><p>Before 2.6.2, the executor pool size in Pulsar was set to <code>20</code> when starting Pulsar services. Users could not configure the executor pool size.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">private final ScheduledExecutorService executor = Executors.newScheduledThreadPool(20,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           new DefaultThreadFactory(&quot;pulsar&quot;));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In 2.6.2, users can configure the executor pool size in the <code>broker.conf</code> file based on their needs.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7782" target="_blank" rel="noopener noreferrer">PR-7782</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-replicated-check-for-checkinactivesubscriptions">Add replicated check for <code>checkInactiveSubscriptions</code><a href="#add-replicated-check-for-checkinactivesubscriptions" class="hash-link" aria-label="Direct link to add-replicated-check-for-checkinactivesubscriptions" title="Direct link to add-replicated-check-for-checkinactivesubscriptions">â€‹</a></h3><p>After the replicated subscription is deleted by <code>checkInactiveSubscriptions</code>, replicated subscriptions are created with <code>receiveSubscriptionUpdated</code>. In this case, the position becomes the latest position.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">topic.createSubscription(update.getSubscriptionName(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        InitialPosition.Latest, true /* replicateSubscriptionState */);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In 2.6.2, the replicated subscription is excluded from automatic deletion by fixing the <code>PersistentTopic</code>.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8066" target="_blank" rel="noopener noreferrer">PR-8066</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-jetty-util-version-to-9431">Upgrade jetty-util version to 9.4.31<a href="#upgrade-jetty-util-version-to-9431" class="hash-link" aria-label="Direct link to Upgrade jetty-util version to 9.4.31" title="Direct link to Upgrade jetty-util version to 9.4.31">â€‹</a></h3><p>Pulsar client depends on jetty-util. Jetty-util versions earlier than 9.4.30 contain known vulnerabilities.</p><p>In 2.6.2, we upgrade the jetty-util version to <code>9.4.31</code> to enhance security.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8035" target="_blank" rel="noopener noreferrer">PR-8035</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-command-to-delete-a-clusters-metadata-from-zookeeper">Add command to delete a cluster&#x27;s metadata from ZooKeeper<a href="#add-command-to-delete-a-clusters-metadata-from-zookeeper" class="hash-link" aria-label="Direct link to Add command to delete a cluster&#x27;s metadata from ZooKeeper" title="Direct link to Add command to delete a cluster&#x27;s metadata from ZooKeeper">â€‹</a></h3><p>When we share the same ZooKeeper and BookKeeper cluster among multiple broker clusters, if a cluster was removed, its metadata in ZooKeeper were also removed.</p><p>In 2.6.2, we fix the issue in the following ways:</p><ul><li>Add a <code>PulsarClusterMetadataTeardown</code> class to delete the relative nodes from ZooKeeper;</li><li>Wrap the class to <code>bin/pulsar</code> script.</li></ul><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8169" target="_blank" rel="noopener noreferrer">PR-8169</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="replace-eventloop-with-threadpoolexecutor-to-improve-performance-instead-of-eventloop">Replace EventLoop with ThreadPoolExecutor to improve performance instead of EventLoop<a href="#replace-eventloop-with-threadpoolexecutor-to-improve-performance-instead-of-eventloop" class="hash-link" aria-label="Direct link to Replace EventLoop with ThreadPoolExecutor to improve performance instead of EventLoop" title="Direct link to Replace EventLoop with ThreadPoolExecutor to improve performance instead of EventLoop">â€‹</a></h3><p>In 2.6.2, we replace EventLoop with a native JDK thread pool(ThreadPoolExecutor) to improve performance.</p><p>The following is the test result with pulsar perf.</p><p>Before 2.6.1:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aggregated throughput stats --- 11715556 records received --- 68813.420 msg/s --- 537.605 Mbit/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In 2.6.2ï¼š</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Aggregated throughput stats --- 18392800 records received --- 133314.602 msg/s --- 1041.520 Mbit/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8208" target="_blank" rel="noopener noreferrer">PR-8208</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fix-deadlock-that-occurred-during-topic-ownership-check">Fix deadlock that occurred during topic ownership check<a href="#fix-deadlock-that-occurred-during-topic-ownership-check" class="hash-link" aria-label="Direct link to Fix deadlock that occurred during topic ownership check" title="Direct link to Fix deadlock that occurred during topic ownership check">â€‹</a></h3><p>Some broker servers had deadlocks while splitting namespace bundles. When checking the thread dump of the broker, some threads were blocked in <code>NamespaceService#getBundle()</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;pulsar-ordered-OrderedExecutor-7-0&quot; #34 prio=5 os_prio=0 tid=0x00007eeeab05a800 nid=0x81a5 waiting on condition [0x00007eeeafbd2000]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  java.lang.Thread.State: WAITING (parking)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       at sun.misc.Unsafe.park(Native Method)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       - parking to wait for  &lt;0x00007f17fa965418&gt; (a java.util.concurrent.CompletableFuture$Signaller)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       at org.apache.pulsar.common.naming.NamespaceBundleFactory.getBundles(NamespaceBundleFactory.java:155)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The reason for the issue is that the <code>getBundle()</code> method leads to deadlock in <code>NamespaceService#isTopicOwned()</code>. To fix the issue, we remove the <code>getBundle()</code> method. When <code>isTopicOwned()</code> returns <code>false</code>, the bundle metadata is cached and can be got asynchronously. When the client reconnects the next time, Pulsar returns the correct bundle metadata from the cache.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8406" target="_blank" rel="noopener noreferrer">PR-8406</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="proxy">Proxy<a href="#proxy" class="hash-link" aria-label="Direct link to Proxy" title="Direct link to Proxy">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enable-users-to-configure-advertisedaddress-in-proxy">Enable users to configure <code>advertisedAddress</code> in proxy<a href="#enable-users-to-configure-advertisedaddress-in-proxy" class="hash-link" aria-label="Direct link to enable-users-to-configure-advertisedaddress-in-proxy" title="Direct link to enable-users-to-configure-advertisedaddress-in-proxy">â€‹</a></h3><p>Before 2.6.2, users could not configure <code>advertisedAddress</code> on the proxy side. In 2.6.2, users can configure <code>advertisedAddress</code> in proxy just as they do in Pulsar broker.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7542" target="_blank" rel="noopener noreferrer">PR-7542</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-proxy-plugin-interface-to-support-user-defined-additional-servlet">Add proxy plugin interface to support user defined additional servlet<a href="#add-proxy-plugin-interface-to-support-user-defined-additional-servlet" class="hash-link" aria-label="Direct link to Add proxy plugin interface to support user defined additional servlet" title="Direct link to Add proxy plugin interface to support user defined additional servlet">â€‹</a></h3><p>To enable users to access the broker flexibly, Pulsar provides plugins similar to broker protocol and broker interceptor. However, users could not access the proxy before 2.6.2.</p><p>To enable users to customize data requests in proxy, we add the protocol plugin for proxy in 2.6.2.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8067" target="_blank" rel="noopener noreferrer">PR-8067</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fix-the-null-exception-when-starting-the-proxy-service">Fix the null exception when starting the proxy service<a href="#fix-the-null-exception-when-starting-the-proxy-service" class="hash-link" aria-label="Direct link to Fix the null exception when starting the proxy service" title="Direct link to Fix the null exception when starting the proxy service">â€‹</a></h3><p>When enabling the broker TLS and broker client authentication with OAuth2 plugin,
the proxy service exits with an unexpected null exception.</p><p>The reason is that when initializing the flow, authentication is called, so the token client is not initialized before using.</p><p>In 2.6.2, we fix the null exception when starting the proxy service.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8019" target="_blank" rel="noopener noreferrer">PR-8019</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="java-client">Java Client<a href="#java-client" class="hash-link" aria-label="Direct link to Java Client" title="Direct link to Java Client">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-input-stream-for-truststore-cert">Support input-stream for trustStore cert<a href="#support-input-stream-for-truststore-cert" class="hash-link" aria-label="Direct link to Support input-stream for trustStore cert" title="Direct link to Support input-stream for trustStore cert">â€‹</a></h3><p>In 2.6.1, Pulsar supports dynamic cert loading by using input stream for TLS cert and key file. The feature is mainly used by container. However, container also requires dynamic loading for truststore certs and users cannot store trust-store cert into file-system. </p><p>In 2.6.2, Pulsar supports loading truststore cert dynamically using input stream.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7442" target="_blank" rel="noopener noreferrer">PR-7442</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="avoid-subscribing-the-same-topic">Avoid subscribing the same topic<a href="#avoid-subscribing-the-same-topic" class="hash-link" aria-label="Direct link to Avoid subscribing the same topic" title="Direct link to Avoid subscribing the same topic">â€‹</a></h3><p>The current key of <code>MultiTopicsConsumerImpl.topics</code> is the topic name passed by the user. The <code>topicNameValid</code> method checks if the name is valid and <code>topics</code> doesn&#x27;t contain the key.</p><p>However, if a multi-topic consumer subscribes a partition of a subscribed partitioned topic,  <code>subscribeAsync</code> succeeds and a new <code>ConsumerImpl</code> of the same partition is created, which is redundant.</p><p>Also, if a multi-topic consumer subscribes <code>public/default/topic</code> or <code>persistent://public/default/topic</code>, while the initial subscribed topic is <code>topic</code>, the redundant consumers would be created.</p><p>In 2.6.2, we fix the issue in the following ways to avoid subscribing the same topic again:</p><ul><li>Use the full topic name as key for <code>MultiTopicsConsumerImpl.topics</code>.</li><li>Check that both the full topic name and the full partitioned topic name do not exist in <code>MultiTopicsConsumerImpl.topics</code> when <code>subscribeAsync</code> is called.</li><li>Throw a different exception to a different topic is invalid and the topic is already subscribed</li></ul><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7823" target="_blank" rel="noopener noreferrer">PR-7823</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cpp-client">CPP Client<a href="#cpp-client" class="hash-link" aria-label="Direct link to CPP Client" title="Direct link to CPP Client">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wait-for-all-seek-operations-complete">Wait for all seek operations complete<a href="#wait-for-all-seek-operations-complete" class="hash-link" aria-label="Direct link to Wait for all seek operations complete" title="Direct link to Wait for all seek operations complete">â€‹</a></h3><p>When a partitioned consumer calls <code>seek</code>, it waits for only one partition&#x27;s seek operation completion because each internal consumer calls callback(result) to complete the same promise.</p><p>In 2.6.2, we use the following methods to avoid this problem:</p><ul><li>Add a <code>MultiResultCallback</code> implementation, the callback completes only when all N events complete successfully or one of N events fails.</li><li>Use <code>MultiResultCallback</code> to wrap callback from <code>PartitionedConsumerImpl::seekAsync</code>.</li></ul><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7216" target="_blank" rel="noopener noreferrer">PR-7216</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="make-clear-thread-safe">Make <code>clear()</code> thread-safe<a href="#make-clear-thread-safe" class="hash-link" aria-label="Direct link to make-clear-thread-safe" title="Direct link to make-clear-thread-safe">â€‹</a></h3><p>Before 2.6.2, the <code>clear()</code> methods of <code>BatchAcknowledgementTracker</code> and <code>UnAckedMessageTrackerEnabled</code> are not thread-safe.</p><p>In 2.6.2, we acquire a mutex in these <code>clear()</code> methods to make it thread-safe.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7862" target="_blank" rel="noopener noreferrer">PR-7862</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-snappy-library-to-docker-images-for-building-c-packages">Add Snappy library to Docker images for building C++ packages<a href="#add-snappy-library-to-docker-images-for-building-c-packages" class="hash-link" aria-label="Direct link to Add Snappy library to Docker images for building C++ packages" title="Direct link to Add Snappy library to Docker images for building C++ packages">â€‹</a></h3><p>The program crashes when Snappy compression is enabled on the C++ client packaged as RPM/DEB. This is because Snappy library is not included in the Docker image for building the RPM/DEB package.</p><p>In 2.6.2, we add the Snappy library to the docker images to avoid the issue.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8086" target="_blank" rel="noopener noreferrer">PR-8086</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-key-based-batching">Support key based batching<a href="#support-key-based-batching" class="hash-link" aria-label="Direct link to Support key based batching" title="Direct link to Support key based batching">â€‹</a></h3><p>Support key based batching for the C++ client. In addition, currently, the implementation of <code>BatchMessageContainer</code> is coupling to <code>ProducerImpl</code> tightly. The batch message container registers a timer to the producer&#x27;s executor and the timeout callback is also the producer&#x27;s method. Even its <code>add</code> method could call <code>sendMessage</code> to send a batch to the producer&#x27;s pending queue. These should be the producer&#x27;s work.</p><p>In 2.6.2, we implement the feature in the following ways:</p><ul><li>Add a <code>MessageAndCallbackBatch</code> to store a <code>MessageImpl</code> of serialized single messages and a callback list.</li><li>Add a <code>BatchMessageContainerBase</code> to provide interface methods and methods like update/clear message number/bytes, create <code>OpSendMsg</code>.</li><li>Let <code>ProducerImpl</code> manage the batch timer and determine whether to create <code>OpSendMsg</code> from <code>BatchMessageContainerBase</code> and send it.</li><li>Make <code>BatchMessageContainer</code> inherit <code>BatchMessageContainerBase</code>, it only manages a <code>MessageAndCallbackBatch</code>.</li><li>Add a <code>BatchMessageKeyBasedContainer</code> that inherits <code>BatchMessageContainerBase</code>, it manages a map of message key and <code>MessageAndCallbackBatch</code>.</li><li>Add a producer config to change batching type.</li></ul><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7996" target="_blank" rel="noopener noreferrer">PR-7996</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="functions">Functions<a href="#functions" class="hash-link" aria-label="Direct link to Functions" title="Direct link to Functions">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enable-kubernetes-runtime-to-customize-function-instance-class-path">Enable Kubernetes runtime to customize function instance class path<a href="#enable-kubernetes-runtime-to-customize-function-instance-class-path" class="hash-link" aria-label="Direct link to Enable Kubernetes runtime to customize function instance class path" title="Direct link to Enable Kubernetes runtime to customize function instance class path">â€‹</a></h3><p>Before 2.6.2, the function worker&#x27;s classpath is used to configure the function instance (runner)&#x27;s classpath. When the broker (function worker) uses an image that is different from the function instance (runner) for Kubernetes runtime, the classpath is wrong and the function instance could not load the instance classes.</p><p>In 2.6.2, we add a function instance classpath entry to the Kubernetes runtime config, and construct the function launch command accordingly.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7844" target="_blank" rel="noopener noreferrer">PR-7844</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set-dryrun-of-kubernetes-runtime-to-null">Set <code>dryrun</code> of Kubernetes Runtime to null<a href="#set-dryrun-of-kubernetes-runtime-to-null" class="hash-link" aria-label="Direct link to set-dryrun-of-kubernetes-runtime-to-null" title="Direct link to set-dryrun-of-kubernetes-runtime-to-null">â€‹</a></h3><p>Before 2.6.2, we upgraded the <code>client-java</code> of Kubernetes to <code>0.9.2</code> to enhance security. However, during the creation of statefulsets, secrets, and services, the value of <code>dryrun</code> was set to <code>true</code>, which was not accepted by Kubernetes. Only <code>All</code> is allowed in Kubernetes. </p><p>In 2.6.2, we set the <code>dryrun</code> of Kubernetes Runtime to null.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8064" target="_blank" rel="noopener noreferrer">PR-8064</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pulsar-sql">Pulsar SQL<a href="#pulsar-sql" class="hash-link" aria-label="Direct link to Pulsar SQL" title="Direct link to Pulsar SQL">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-presto-version-to-332">Upgrade Presto version to 332<a href="#upgrade-presto-version-to-332" class="hash-link" aria-label="Direct link to Upgrade Presto version to 332" title="Direct link to Upgrade Presto version to 332">â€‹</a></h3><p>Upgrade Presto version to 332. Resolve different packages between prestosql and prestodb. Although the latest version is 334, versions higher than 333 require Java 11.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7194" target="_blank" rel="noopener noreferrer">PR-7194</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pulsar-admin">pulsar-admin<a href="#pulsar-admin" class="hash-link" aria-label="Direct link to pulsar-admin" title="Direct link to pulsar-admin">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-cli-command-to-get-the-last-message-id">Add CLI command to get the last message ID<a href="#add-cli-command-to-get-the-last-message-id" class="hash-link" aria-label="Direct link to Add CLI command to get the last message ID" title="Direct link to Add CLI command to get the last message ID">â€‹</a></h3><p>Add <code>last-message-id</code> command in CLI, so users can get the last message ID with this command.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8082" target="_blank" rel="noopener noreferrer">PR-8082</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-deleting-schema-ledgers-when-deleting-topics">Support deleting schema ledgers when deleting topics<a href="#support-deleting-schema-ledgers-when-deleting-topics" class="hash-link" aria-label="Direct link to Support deleting schema ledgers when deleting topics" title="Direct link to Support deleting schema ledgers when deleting topics">â€‹</a></h3><p>Users could not delete schema of topics with the <code>PersistentTopics#deleteTopic</code> and <code>PersistentTopics#deletePartitionedTopic</code> in REST APIs. After topics were deleted, the schema ledgers still existed with adding an empty schema ledger.</p><p>In 2.6.2, we implement the feature in the following ways:</p><ul><li>Add a <code>deleteSchema</code> query param to REST APIs of deleting topics/partitioned topics;</li><li>Add a map to record the created ledgers in <code>BookkeeperSchemaStorage</code>;</li><li>Expose <code>deleteSchema</code> param in pulsar-admin APIs;</li><li>Delete schema ledgers when deleting the cluster with <code>-a</code> option.</li></ul><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8167" target="_blank" rel="noopener noreferrer">PR-8167</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-deleting-all-data-associated-with-a-cluster">Support deleting all data associated with a cluster<a href="#support-deleting-all-data-associated-with-a-cluster" class="hash-link" aria-label="Direct link to Support deleting all data associated with a cluster" title="Direct link to Support deleting all data associated with a cluster">â€‹</a></h3><p>When multiple broker clusters shared the same bookie cluster, if users wanted to remove a broker cluster, the associated ledgers in bookies were not deleted as expected.</p><p>In 2.6.2, we add a <code>cluster delete</code> command to enable users to delete all the data associated with the cluster.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8133" target="_blank" rel="noopener noreferrer">PR-8133</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pulsar-perf">Pulsar Perf<a href="#pulsar-perf" class="hash-link" aria-label="Direct link to Pulsar Perf" title="Direct link to Pulsar Perf">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enable-users-to-configure-iothread-number-in-pulsar-perf">Enable users to configure ioThread number in pulsar-perf<a href="#enable-users-to-configure-iothread-number-in-pulsar-perf" class="hash-link" aria-label="Direct link to Enable users to configure ioThread number in pulsar-perf" title="Direct link to Enable users to configure ioThread number in pulsar-perf">â€‹</a></h3><p>In pulsar-perf, the default Pulsar client ioThread number is <code>Runtime.getRuntime().availableProcessors()</code> and users could not configure it in the command line. When running a pulsar-perf producer, it may cause messages to enqueue competition and lead to high latency.</p><p>In 2.6.2, we implement the feature in the following ways:</p><ol><li>Enable users to configure the ioThread number in the command line;</li><li>Change the default ioThead number from <code>Runtime.getRuntime().availableProcessors()</code> to <code>1</code></li></ol><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/8090" target="_blank" rel="noopener noreferrer">PR-8090</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-information">More information<a href="#more-information" class="hash-link" aria-label="Direct link to More information" title="Direct link to More information">â€‹</a></h2><ul><li>To download Apache Pulsar 2.6.2, click <a href="https://pulsar.apache.org/download/" target="_blank" rel="noopener noreferrer">download</a>.</li><li>For more information about Apache Pulsar 2.6.2, see <!-- -->[2.6.2 release notes]<!-- -->(<a href="https://pulsar.apache.org/release-notes/#2.6.2" target="_blank" rel="noopener noreferrer">https://pulsar.apache.org/release-notes/#2.6.2</a> and <a href="https://github.com/apache/pulsar/pulls?q=is%3Apr+label%3Arelease%2F2.6.2+is%3Aclosed" target="_blank" rel="noopener noreferrer">2.6.2 PR list</a>.</li></ul><p>If you have any questions or suggestions, contact us with mailing lists or slack.</p><ul><li><a href="mailto:users@pulsar.apache.org" target="_blank" rel="noopener noreferrer">users@pulsar.apache.org</a></li><li><a href="mailto:dev@pulsar.apache.org" target="_blank" rel="noopener noreferrer">dev@pulsar.apache.org</a></li><li>Pulsar slack channel: <a href="https://apache-pulsar.slack.com/" target="_blank" rel="noopener noreferrer">https://apache-pulsar.slack.com/</a></li><li>Self-registration at <a href="https://apache-pulsar.herokuapp.com/" target="_blank" rel="noopener noreferrer">https://apache-pulsar.herokuapp.com/</a></li></ul><p>Looking forward to your contributions to <a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer">Pulsar</a>.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col margin-top--sm"><a href="https://github.com/apache/pulsar-site/edit/main/blog/2020-11-09-Apache-Pulsar-2-6-2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2020/12/24/Apache-Pulsar-2-7-0/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Apache Pulsar 2.7.0</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2020/11/04/pulsar-summit-asia-schedule/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Pulsar Summit Asia 2020 Schedule is Now Online</div></a></nav></main><div class="col col--2"><div class="tableOfContents_jeP5 thin-scrollbar"><div class="border"><div style="color:var(--ifm-toc-link-color)">Was this helpful?</div><div style="border-width:1px;padding:3px;display:flex"><div style="justify-content:center;display:flex;border-radius:99999px;width:2.5rem;height:2.5rem;cursor:pointer;background:;color:"><svg style="width:initial;height:initial" width="12" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.086 1.594A1 1 0 0 1 11 1a4 4 0 0 1 4 4v3h4.655a3 3 0 0 1 2.994 3.45l-1.38 9A3.002 3.002 0 0 1 18.275 23H4a3 3 0 0 1-3-3v-7a3 3 0 0 1 3-3h2.35l3.736-8.406ZM8 11.212l3.608-8.117A2 2 0 0 1 13 5v4a1 1 0 0 0 1 1h5.671a1 1 0 0 1 1 1.15l-1.38 9a1 1 0 0 1-1 .85H8v-9.788ZM6 21v-9H4a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h2Z" fill="currentColor"></path></svg></div><div style="justify-content:center;display:flex;border-radius:99999px;width:2.5rem;height:2.5rem;cursor:pointer;margin-left:30px;background:;color:"><svg style="width:initial;height:initial" width="12" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M20.563 3.316A1.31 1.31 0 0 0 19.687 3h-1.688v9h1.688a1.31 1.31 0 0 0 1.312-1.077V4.077a1.31 1.31 0 0 0-.436-.761ZM16 12.788l-3.608 8.117A1.999 1.999 0 0 1 11 19v-4a1 1 0 0 0-1-1H4.328a1.002 1.002 0 0 1-1-1.15l1.38-9a1 1 0 0 1 1-.85h10.291v9.788ZM19.661 1a3.31 3.31 0 0 1 3.329 2.866c.006.044.01.09.01.134v7c0 .045-.004.09-.01.134A3.31 3.31 0 0 1 19.661 14h-2.012l-3.736 8.406a1 1 0 0 1-.914.594 4 4 0 0 1-4-4v-3H4.344a3 3 0 0 1-2.994-3.45l1.38-9A3.002 3.002 0 0 1 5.724 1h13.937Z" fill="currentColor"></path></svg></div></div></div><ul class="table-of-contents table-of-contents__left-border"><li><a href="#broker" class="table-of-contents__link toc-highlight">Broker</a><ul><li><a href="#catch-throwable-when-starting-pulsar" class="table-of-contents__link toc-highlight">Catch <code>throwable</code> when starting Pulsar</a></li><li><a href="#handle-subscriptionbusyexception-in-resetcursor-api" class="table-of-contents__link toc-highlight">Handle SubscriptionBusyException in resetCursor API</a></li><li><a href="#update-jersey-to-231" class="table-of-contents__link toc-highlight">Update Jersey to 2.31</a></li><li><a href="#stop-to-dispatch-when-consumers-using-the-key_shared-subscription-stuck" class="table-of-contents__link toc-highlight">Stop to dispatch when consumers using the Key_Shared subscription stuck</a></li><li><a href="#reestablish-namespace-bundle-ownership-from-false-negative-releasing-and-false-positive-acquiring" class="table-of-contents__link toc-highlight">Reestablish namespace bundle ownership from false negative releasing and false positive acquiring</a></li><li><a href="#enable-users-to-configure-the-executor-pool-size" class="table-of-contents__link toc-highlight">Enable users to configure the executor pool size</a></li><li><a href="#add-replicated-check-for-checkinactivesubscriptions" class="table-of-contents__link toc-highlight">Add replicated check for <code>checkInactiveSubscriptions</code></a></li><li><a href="#upgrade-jetty-util-version-to-9431" class="table-of-contents__link toc-highlight">Upgrade jetty-util version to 9.4.31</a></li><li><a href="#add-command-to-delete-a-clusters-metadata-from-zookeeper" class="table-of-contents__link toc-highlight">Add command to delete a cluster&#39;s metadata from ZooKeeper</a></li><li><a href="#replace-eventloop-with-threadpoolexecutor-to-improve-performance-instead-of-eventloop" class="table-of-contents__link toc-highlight">Replace EventLoop with ThreadPoolExecutor to improve performance instead of EventLoop</a></li><li><a href="#fix-deadlock-that-occurred-during-topic-ownership-check" class="table-of-contents__link toc-highlight">Fix deadlock that occurred during topic ownership check</a></li></ul></li><li><a href="#proxy" class="table-of-contents__link toc-highlight">Proxy</a><ul><li><a href="#enable-users-to-configure-advertisedaddress-in-proxy" class="table-of-contents__link toc-highlight">Enable users to configure <code>advertisedAddress</code> in proxy</a></li><li><a href="#add-proxy-plugin-interface-to-support-user-defined-additional-servlet" class="table-of-contents__link toc-highlight">Add proxy plugin interface to support user defined additional servlet</a></li><li><a href="#fix-the-null-exception-when-starting-the-proxy-service" class="table-of-contents__link toc-highlight">Fix the null exception when starting the proxy service</a></li></ul></li><li><a href="#java-client" class="table-of-contents__link toc-highlight">Java Client</a><ul><li><a href="#support-input-stream-for-truststore-cert" class="table-of-contents__link toc-highlight">Support input-stream for trustStore cert</a></li><li><a href="#avoid-subscribing-the-same-topic" class="table-of-contents__link toc-highlight">Avoid subscribing the same topic</a></li></ul></li><li><a href="#cpp-client" class="table-of-contents__link toc-highlight">CPP Client</a><ul><li><a href="#wait-for-all-seek-operations-complete" class="table-of-contents__link toc-highlight">Wait for all seek operations complete</a></li><li><a href="#make-clear-thread-safe" class="table-of-contents__link toc-highlight">Make <code>clear()</code> thread-safe</a></li><li><a href="#add-snappy-library-to-docker-images-for-building-c-packages" class="table-of-contents__link toc-highlight">Add Snappy library to Docker images for building C++ packages</a></li><li><a href="#support-key-based-batching" class="table-of-contents__link toc-highlight">Support key based batching</a></li></ul></li><li><a href="#functions" class="table-of-contents__link toc-highlight">Functions</a><ul><li><a href="#enable-kubernetes-runtime-to-customize-function-instance-class-path" class="table-of-contents__link toc-highlight">Enable Kubernetes runtime to customize function instance class path</a></li><li><a href="#set-dryrun-of-kubernetes-runtime-to-null" class="table-of-contents__link toc-highlight">Set <code>dryrun</code> of Kubernetes Runtime to null</a></li></ul></li><li><a href="#pulsar-sql" class="table-of-contents__link toc-highlight">Pulsar SQL</a><ul><li><a href="#upgrade-presto-version-to-332" class="table-of-contents__link toc-highlight">Upgrade Presto version to 332</a></li></ul></li><li><a href="#pulsar-admin" class="table-of-contents__link toc-highlight">pulsar-admin</a><ul><li><a href="#add-cli-command-to-get-the-last-message-id" class="table-of-contents__link toc-highlight">Add CLI command to get the last message ID</a></li><li><a href="#support-deleting-schema-ledgers-when-deleting-topics" class="table-of-contents__link toc-highlight">Support deleting schema ledgers when deleting topics</a></li><li><a href="#support-deleting-all-data-associated-with-a-cluster" class="table-of-contents__link toc-highlight">Support deleting all data associated with a cluster</a></li></ul></li><li><a href="#pulsar-perf" class="table-of-contents__link toc-highlight">Pulsar Perf</a><ul><li><a href="#enable-users-to-configure-iothread-number-in-pulsar-perf" class="table-of-contents__link toc-highlight">Enable users to configure ioThread number in pulsar-perf</a></li></ul></li><li><a href="#more-information" class="table-of-contents__link toc-highlight">More information</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="social-icons">
                  <a target="_blank" href="https://communityinviter.com/apps/apache-pulsar/apache-pulsar" aria-label="Join the Apache Pulsar Slack workspace">
                    <img alt="Slack logo" src="/img/slack-white.svg" width="26">
                  </a>
                  <a target="_blank" href="https://github.com/apache/pulsar/" aria-label="View the Apache Pulsar project on GitHub">
                    <img alt="GitHub logo" src="/img/github-white.svg" width="26">
                  </a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">
        <div>
          <img class="footer-apache-logo" src="/img/feather-logo-white.svg" alt="" width="20">
          The Apache Software Foundation
        </div>
        <p>Apache Pulsar is available under the Apache License, version 2.0. Apache Pulsar is an open-source, distributed messaging and streaming platform built for the cloud.</p>
        <p>Copyright Â© 2024 The Apache Software Foundation. All Rights Reserved. Apache, Pulsar, Apache Pulsar, and the Apache feather logo are trademarks or registered trademarks of The Apache Software Foundation.</p>
      </div></div></div></footer></div>
<script src="/assets/js/runtime~main.e61b3335.js"></script>
<script src="/assets/js/main.47f55566.js"></script>
</body>
</html>